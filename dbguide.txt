-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.Courts (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  name text NOT NULL,
  max_capacity bigint,
  status text,
  CONSTRAINT Courts_pkey PRIMARY KEY (id)
);
CREATE TABLE public.Memberships (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  user_id bigint,
  team_id bigint,
  joined_at timestamp with time zone DEFAULT now(),
  CONSTRAINT Memberships_pkey PRIMARY KEY (id),
  CONSTRAINT Memberships_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.Profiles(id),
  CONSTRAINT Memberships_team_id_fkey FOREIGN KEY (team_id) REFERENCES public.Teams(id)
);
CREATE TABLE public.Profiles (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  lname text NOT NULL,
  fname text,
  email text UNIQUE,
  qr_code_token bigint,
  auth_id uuid UNIQUE,
  qr_code_id bigint UNIQUE,
  CONSTRAINT Profiles_pkey PRIMARY KEY (id)
);
CREATE TABLE public.Sessions (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  user_id bigint,
  court_id bigint,
  check_in_at timestamp with time zone DEFAULT now(),
  check_out_at timestamp with time zone,
  CONSTRAINT Sessions_pkey PRIMARY KEY (id),
  CONSTRAINT Sessions_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.Profiles(id),
  CONSTRAINT Sessions_court_id_fkey FOREIGN KEY (court_id) REFERENCES public.Courts(id)
);
CREATE TABLE public.Stats (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  user_id bigint,
  action_type text,
  points integer,
  session_id bigint,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT Stats_pkey PRIMARY KEY (id),
  CONSTRAINT Stats_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.Profiles(id),
  CONSTRAINT Stats_session_id_fkey FOREIGN KEY (session_id) REFERENCES public.Sessions(id)
);
CREATE TABLE public.Teams (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  name text NOT NULL UNIQUE,
  coach_id bigint,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT Teams_pkey PRIMARY KEY (id),
  CONSTRAINT Teams_coach_id_fkey FOREIGN KEY (coach_id) REFERENCES public.Profiles(id)
);
CREATE TABLE public.gym_configs (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  opening_time timestamp with time zone NOT NULL DEFAULT now(),
  closing_time timestamp without time zone,
  location text,
  CONSTRAINT gym_configs_pkey PRIMARY KEY (id)
);